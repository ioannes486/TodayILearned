# 해시와 해시테이블

### 오늘 배운 내용을 자료 안보고 적어보기

- 해시함수는 임의의 정수 값을 반환한다.
- 임의로 넣기 때문에 set.pop()을 수행하면 임의의 값을 반환하는 것이다.
- 이러한 임의성은 해시함수가 난수 시드에 따라 정수를 반환하여 버킷에 주소값을 넣기 때문이다
- 정수형은 해쉬함수가 그대로 정수를 반환하기 때문에 pop()의 순서는 똑같이 나온다. 하지만 내부적으로 해쉬함수가 어떻게 돌아가는지 알수 없기 때문에 순서를 예측할 수는 없다. 돌려봐야 안다.

### 해시 테이블이란?

> **키와 값을 짝지어 저장하는 자료구조이다**
> 도서관에서 책을 찾기 위해 키로 한방에 접근할 수 있도록 하는 것처럼 빠른 인덱싱을 가능하게 한다

### 해시 테이블의 원리

1. 키를 해시 함수를 통해 해시 값으로 변환
2. 변환된 해시 값을 인덱스로 삼아 데이터를 저장하거나 찾음
3. 이로 인해 검색, 삽입, 삭제를 매우 빠르게 수행
   ![](https://velog.velcdn.com/images/rhkdghks21/post/7b9f55f9-cdda-436e-bad3-baf913051196/image.png)
   > 값을 바로 찾아갈 수 있는 이유는 해시함수 덕이다

### 해시

> 임의의 크기를 가진 데이터를 고정된 크기의 고유한 값으로 변환하는 것

- 생성된 해시 값(고유한 정수)는 해당 데이터를 식별하는 '지문' 역할을 함
- 파이선에서는 이 해시 값을 이용해 해시테이블에 데이터를 저장
- **이 변환을 수행하는 것이 <span style = color:red>해시함수이다**</span>

### 해시 함수

> 임의 길이 데이터를 입력 받아 고정길이(정수)로 변환해 주는 함수, 이 '정수'가 바로 해시 값

### hashable

> hashable함수에 넣어 해시 값을 구할 수 있는 객체를 의미한다

- 매직메서드에서 `__hash__` 와 `__eq__`가 포함되어 있으면 이는 hashable인터페이스를 구현하고 있음을 의미한다. 때문에 해시값을 구할 수 있다.
- 해시 가능하다 == 불변이다 가 절대적이지는 않지만 내장 자료형 기준에서는 불변이어야 해시 가능하다

```python
# 해시 가능하다 <=> 불변이다가 성립하지 않는 반례
tup = ([1,2,],[3,4,],[5,6],[7,8])  # 튜플은 불변객체이나 원소로 가변객체가 있으면 해셔블 하지 않다.
hash(tup)
```

> **가변객체가 hashable하지 않은 이유?**
> 같은 객체도 값이 바뀌면 해시값이 달라질 수 있다. 객체는 내부 상태, 즉 값이 바뀐다.

### hashable객체가 필요한 이유

1. 해시테이블 기반의 자료 구조 사용

- set의 요소, dict의 키
- 중복 방지와 빠른 검색, 조회

2. 불변성을 통한 일관된 해시 값

- 한번 해시값이 정해지면 바뀌지 않아서 **해시 테이블 무결성**이 유지된다

3. 안정성과 예측 가능성 유지

- 동일한 데이터는 항상 동일한 해시 값을 반환 -> 로직을 단순화

> 🤔**여기서 잠깐**
> 동일한 데이터가 항상 동일한 해시 값을 반환하는 것은 같은 파이선 인터프리터, 즉 같은 파이선 세션 안에서만 동일하다. 서로 다른 세션간의 hash함수 호출은 다른 해시값을 반환한다.

### 대표적인 hashable 객체의 예시 - set

set은 순서를 보장하지 않는다. 즉 이말은 for문으로 순회를 할 때조차 순서를 보장하지 않는다는 이야기이다. 아래의 코드를 보자

```python
my_set = {'가', '나', (0, 0)}
my_dict = {
        '가': 1,
        (0, 0): '튜플도 키값으로 사용가능'
    }

for elem in my_set:
  print(my_dict.get(elem))

var = 'she sells sea shore shells'
my_dict[var] = '변수로도 키 설정 가능'
print(my_dict)
```

이 코드를 실행할 경우 아래와 같이 None과 1의 출력순서를 보장하지 않는다.
![](https://velog.velcdn.com/images/rhkdghks21/post/807f8a74-5357-46dc-bfdd-518b527ede08/image.png)![](https://velog.velcdn.com/images/rhkdghks21/post/c10135dd-02b1-4f6a-b5cf-c554222ed36e/image.png)

# 질문사항

- 근데 왜 임의성이 생길까? 가설 1 : 난수 시드에 따라서 난수 순? 아니면 해쉬함수에 들어간 순? 아니면 해쉬함수로 생긴 정수의 역순?
- 난수 시드가 생성되는 이유?
- 파이선에서 사용하는 해쉬 알고리즘?
